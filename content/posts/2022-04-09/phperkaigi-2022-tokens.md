---
title: "PHPerKaigi 2022 ãƒˆãƒ¼ã‚¯ãƒ³å•é¡Œã®è§£èª¬"
date: 2022-04-09T21:50:19+09:00
lastmod: 2022-04-16
draft: false
tags: ["conference", "php", "phperkaigi"]
aliases: ['/posts/phperkaigi-2022-tokens/']
summary: |
    PHPerKaigi 2022 ã§ç§ãŒä½œæˆã—ãŸ PHPer ãƒãƒ£ãƒ¬ãƒ³ã‚¸å•é¡Œã‚’è§£èª¬ã™ã‚‹ã€‚
changelog:
  2022-04-09: å…¬é–‹
  2022-04-16: 2å•ç›®ã€3å•ç›®ã®è§£èª¬ã‚’è¿½åŠ ã€1å•ç›®ã«åŠ ç­†
---

# ã¯ã˜ã‚ã«

æœ¬æ—¥é–‹å§‹ã•ã‚ŒãŸ [PHPerKaigi 2022](https://phperkaigi.jp/2022/) ã® PHPer ãƒãƒ£ãƒ¬ãƒ³ã‚¸ã«ãŠã„ã¦ã€å¼Šç¤¾ [ãƒ‡ã‚¸ã‚¿ãƒ«ã‚µãƒ¼ã‚«ã‚¹æ ªå¼ä¼šç¤¾](https://www.dgcircus.com/) ã®å•é¡Œã‚’ 3å•ä½œæˆã—ãŸã€‚ã“ã®è¨˜äº‹ã§ã¯ã€ã“ã‚Œã‚‰ã®å•é¡Œã®è§£èª¬ã‚’ãŠã“ãªã†ã€‚

ãƒªãƒã‚¸ãƒˆãƒªã¯ã“ã¡ã‚‰: https://github.com/nsfisis/PHPerKaigi2022-tokens



# ç¬¬1å• brainf_ck.php

ã‚½ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ‰ã¯ã“ã¡ã‚‰ã€‚å®Ÿè¡Œã«ã¯ PHP 8.1 ä»¥ä¸ŠãŒå¿…è¦ãªã®ã§æ³¨æ„ã€‚

```php
<?php

declare(strict_types=0O1);

namespace Dgcircus\PHPerKaigi\Y2022;

/**
 * @todo
 * Run this program to acquire a PHPer token.
 */

https://creativecommons.org/publicdomain/zero/1.0/

\error_reporting(~+!'We are hiring!');

$z = fn($f) => (fn($x) => $f(fn(...$xs) => $x($x)(...$xs)))(fn($x) => $f(fn(...$xs) => $x($x)(...$xs)));
$id = \spl_object_id(...);
$put = fn($c) => \printf('%c', $c);
$mm = fn($p, $n) => new \ArrayObject(\array_fill(+!![], $n, $p));

$ğŸ‘‰ = fn($m, $p, $b, $e, $mp, $pc) => [++$mp, ++$pc];
$ğŸ‘ˆ = fn($m, $p, $b, $e, $mp, $pc) => [--$mp, ++$pc];
$ğŸ‘ = fn($m, $p, $b, $e, $mp, $pc) => [$mp, ++$pc, ++$m[$mp]];
$ğŸ‘ = fn($m, $p, $b, $e, $mp, $pc) => [$mp, ++$pc, --$m[$mp]];
$ğŸ“ = fn($m, $p, $b, $e, $mp, $pc) => [$mp, ++$pc, $put($m[$mp])];
$ğŸ¤¡ = fn($m, $p, $b, $e, $mp, $pc) => match ($m[$mp]) {
    +!![] => [$mp, $z(fn($loop) => fn($pc, $n) => match ($id($p[$pc])) {
      $b => $loop(++$pc, ++$n),
      $e => $n === +!![] ? ++$pc : $loop(++$pc, --$n),
      default => $loop(++$pc, $n),
    })($pc, -![])],
    default => [$mp, ++$pc],
};
$ğŸª = fn($m, $p, $b, $e, $mp, $pc) => match ($m[$mp]) {
    +!![] => [$mp, ++$pc],
    default => [$mp, $z(fn($loop) => fn($pc, $n) => match ($id($p[$pc])) {
      $e => $loop(--$pc, ++$n),
      $b => $n === +!![] ? $pc+![] : $loop(--$pc, --$n),
      default => $loop(--$pc, $n),
    })($pc, -![])],
};
$ğŸ˜ = fn($p) => $z(fn($loop) => fn($m, $p, $b, $e, $mp, $pc) =>
  isset($p[$pc]) && $loop($m, $p, $b, $e, ...($p[$pc]($m, $p, $b, $e, $mp, $pc)))
)($mm(+!![], +(![].![])), $p, $id($ğŸ¤¡), $id($ğŸª), +!![], +!![]);

$ğŸ˜([
  $ğŸ‘, $ğŸ‘, $ğŸ‘, $ğŸ‘, $ğŸ‘, $ğŸ‘, $ğŸ‘, $ğŸ‘, $ğŸ‘, $ğŸ‘,
  $ğŸ¤¡,
    $ğŸ‘‰, $ğŸ‘, $ğŸ‘, $ğŸ‘,
    $ğŸ‘‰, $ğŸ‘, $ğŸ‘, $ğŸ‘, $ğŸ‘, $ğŸ‘,
    $ğŸ‘‰, $ğŸ‘, $ğŸ‘, $ğŸ‘, $ğŸ‘, $ğŸ‘, $ğŸ‘, $ğŸ‘, $ğŸ‘, $ğŸ‘, $ğŸ‘, $ğŸ‘, $ğŸ‘,
    $ğŸ‘‰, $ğŸ‘, $ğŸ‘, $ğŸ‘, $ğŸ‘, $ğŸ‘, $ğŸ‘, $ğŸ‘, $ğŸ‘, $ğŸ‘, $ğŸ‘,
    $ğŸ‘ˆ, $ğŸ‘ˆ, $ğŸ‘ˆ, $ğŸ‘ˆ, $ğŸ‘,
  $ğŸª,
  $ğŸ‘‰, $ğŸ‘, $ğŸ‘, $ğŸ‘, $ğŸ‘, $ğŸ‘, $ğŸ“,
  $ğŸ‘, $ğŸ‘, $ğŸ“,
  $ğŸ‘‰, $ğŸ‘, $ğŸ‘, $ğŸ‘, $ğŸ“,
  $ğŸ‘‰, $ğŸ‘, $ğŸ‘, $ğŸ‘, $ğŸ“,
  $ğŸ‘, $ğŸ‘, $ğŸ“,
  $ğŸ‘, $ğŸ“,
  $ğŸ‘ˆ, $ğŸ“,
  $ğŸ‘‰, $ğŸ‘‰, $ğŸ‘, $ğŸ‘, $ğŸ“,
  $ğŸ‘, $ğŸ‘, $ğŸ‘, $ğŸ‘, $ğŸ‘, $ğŸ‘, $ğŸ‘, $ğŸ“,
  $ğŸ‘ˆ, $ğŸ‘, $ğŸ‘, $ğŸ‘, $ğŸ‘, $ğŸ“,
  $ğŸ‘ˆ, $ğŸ“,
  $ğŸ‘‰, $ğŸ‘, $ğŸ‘, $ğŸ“,
  $ğŸ‘‰, $ğŸ‘, $ğŸ“,
  $ğŸ‘ˆ, $ğŸ“,
]);
```

ã“ã®å•é¡Œã¯ã€å˜ã«é©åˆ‡ãªãƒãƒ¼ã‚¸ãƒ§ãƒ³ã® PHP ã§å‹•ã‹ã›ã°ãƒˆãƒ¼ã‚¯ãƒ³ãŒå¾—ã‚‰ã‚Œã‚‹ã€‚


## è§£èª¬

### çµµæ–‡å­—

ã¾ãšç›®ã«ã¤ãã®ã¯å¤§é‡ã®çµµæ–‡å­—ã ã‚ã†ã€‚
PHP ã¯è­˜åˆ¥å­ã«ä½¿ç”¨ã§ãã‚‹æ–‡å­—ã®ç¯„å›²ãŒåºƒãã€çµµæ–‡å­—ã‚‚ä½¿ã†ã“ã¨ãŒã§ãã‚‹ã€‚


### ãƒ—ãƒ­ã‚°ãƒ©ãƒ å…¨ä½“

Brainf\*ck ã®ã‚¤ãƒ³ã‚¿ãƒ—ãƒªã‚¿ã¨ãƒ—ãƒ­ã‚°ãƒ©ãƒ ã«ãªã£ã¦ã„ã‚‹ã€‚
Brainf\*ck ã¨ã¯ã€é›£è§£ãƒ—ãƒ­ã‚°ãƒ©ãƒŸãƒ³ã‚°è¨€èªã®ã²ã¨ã¤ã§ã‚ã‚Šã€ã“ã“ã§èª¬æ˜ã™ã‚‹ã‚ˆã‚Šã‚‚ Wikipedia ã®è©²å½“ãƒšãƒ¼ã‚¸ã‚’èª­ã‚“ã æ–¹ãŒã‚ˆã„ã€‚

https://ja.wikipedia.org/wiki/Brainfuck

ãªãŠã€brainf\*ck ãƒ—ãƒ­ã‚°ãƒ©ãƒ ã‚’æ™®é€šã®æ›¸ãæ–¹ã§æ›¸ãã¨ã€æ¬¡ã®ã‚ˆã†ã«ãªã‚‹ã€‚

```
+ + + + + + + + + +
[
  > + + +
  > + + + + +
  > + + + + + + + + + + + +
  > + + + + + + + + + +
  < < < < -
]
> + + + + + .
- - .
> - - - .
> - - - .
- - .
- .
< .
> > - - .
+ + + + + + + .
< - - - - .
< .
> + + .
> - .
< .
```

å®Ÿè¡Œçµæœã¯ã“ã¡ã‚‰: https://ideone.com/22VWmb

ãã‚Œãã‚Œã®çµµæ–‡å­—ã§è¡¨ã•ã‚ŒãŸé–¢æ•°ãŒã€å„å‘½ä»¤ã«å¯¾å¿œã—ã¦ã„ã‚‹ã€‚

* `$ğŸ‘‰`: `>`
* `$ğŸ‘ˆ`: `<`
* `$ğŸ‘`: `+`
* `$ğŸ‘`: `-`
* `$ğŸ“`: `.`
* `$ğŸ¤¡`: `[`
* `$ğŸª`: `]`

`,` (å…¥åŠ›) ã«å¯¾å¿œã™ã‚‹é–¢æ•°ã¯ãªã„ (ã“ã®ãƒ—ãƒ­ã‚°ãƒ©ãƒ ã§ã¯ä½¿ã‚ãªã„ã®ã§ç”¨æ„ã—ã¦ã„ãªã„)ã€‚

ãªãŠã€`$ğŸ˜` ã¯ã„ã‚ã‚†ã‚‹ main é–¢æ•°ã§ã‚ã‚Šã€ãƒ—ãƒ­ã‚°ãƒ©ãƒ ã®å®Ÿè¡Œéƒ¨åˆ†ã§ã‚ã‚‹ã€‚


### çµµæ–‡å­—ã®é¸æŠ

ãŠãŠã‚ˆãæ„å‘³ã«åˆè‡´ã™ã‚‹ã‚ˆã†é¸ã‚“ã§ã„ã‚‹ãŒã€`$ğŸ¤¡` ã¨ `$ğŸª` ã¯å¼Šç¤¾ãƒ‡ã‚¸ã‚¿ãƒ«ã‚µãƒ¼ã‚«ã‚¹ã«ã¡ãªã‚“ã§ã„ã‚‹ã€‚
ã¾ãŸã€`$ğŸ˜` ã¯ PHP ã®ãƒã‚¹ã‚³ãƒƒãƒˆã®è±¡ã«ç”±æ¥ã™ã‚‹ã€‚


### strict_types

`declare` æ–‡ã® `strict_types` ã«æŒ‡å®šã§ãã‚‹ã®ã¯ã€`0` ã‹ `1` ã®æ•°å€¤ãƒªãƒ†ãƒ©ãƒ«ã ãŒã€
`0x0` ã‚„ `0b1` ã®ã‚ˆã†ãªå€¤ã‚‚å—ã‘ä»˜ã‘ã‚‹ã€‚
ä»Šå›ã¯ã€PHP 8.1 ã‹ã‚‰è¿½åŠ ã•ã‚ŒãŸã€`0O` ã¾ãŸã¯ `0o` ã‹ã‚‰å§‹ã¾ã‚‹å…«é€²æ•°ãƒªãƒ†ãƒ©ãƒ«ã‚’ä½¿ã£ãŸã€‚


### URL

ã‚½ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ‰ã®ãƒ©ã‚¤ã‚»ãƒ³ã‚¹ã‚’ç¤ºã—ãŸã“ã®éƒ¨åˆ†ã ãŒã€

```php
https://creativecommons.org/publicdomain/zero/1.0/
```

å®Œå…¨ã«åˆæ³•ãª PHP ã®ã‚³ãƒ¼ãƒ‰ã§ã‚ã‚‹ã€‚
`https:` éƒ¨åˆ†ã¯ãƒ©ãƒ™ãƒ«ã€`//` ä»¥é™ã¯è¡Œã‚³ãƒ¡ãƒ³ãƒˆã«ãªã£ã¦ã„ã‚‹ã€‚


### ãƒªãƒ†ãƒ©ãƒ«ãªã—ã§æ•°å€¤ã‚’ç”Ÿæˆã™ã‚‹

ã‚½ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ‰ä¸­ã«ã€ã»ã¨ã‚“ã©æ•°å€¤ãƒªãƒ†ãƒ©ãƒ«ãŒæ›¸ã‹ã‚Œã¦ã„ãªã„ã“ã¨ã«ãŠæ°—ã¥ãã ã‚ã†ã‹ã€‚
PHP ã§ã¯ã€å‹å¤‰æ›ã‚’åˆ©ç”¨ã™ã‚‹ã“ã¨ã§ä»»æ„ã®æ•´æ•°ã‚’ä½œã‚Šå‡ºã™ã“ã¨ãŒã§ãã‚‹ã€‚

```php
assert(0 === +!![]);
assert(1 === +![]);
assert(2 === ![]+![]);
assert(3 === ![]+![]+![]);
assert(10 === +(![].+!![]));
```

`[]` ã« `!` ã‚’é©ç”¨ã™ã‚‹ã¨ `true` ãŒè¿”ã£ã¦ãã‚‹ã€‚ãã‚Œã« `+`
ã‚’é©ç”¨ã™ã‚‹ã¨ã€`bool` ã‹ã‚‰ `int` ãƒ˜ã®å‹å¤‰æ›ãŒèµ°ã‚Šã€`1` ãŒç”Ÿæˆã•ã‚Œã‚‹ã€‚`10`
ã¯ã•ã‚‰ã«ãƒˆãƒªãƒƒã‚­ãƒ¼ã ã€‚ã¾ãš `1` ã¨ `0` ã‚’ä½œã‚Šã€`.` ã§æ–‡å­—åˆ—ã¨ã—ã¦çµåˆã™ã‚‹
(`'10'`)ã€‚ã“ã‚Œã« `+` ã‚’é©ç”¨ã™ã‚‹ã¨ã€`string` ã‹ã‚‰ `int`
ã¸ã®å‹å¤‰æ›ãŒèµ°ã‚Šã€`10` ãŒç”Ÿã¾ã‚Œã‚‹ (ã‚³ãƒ¼ãƒ‰é‡ã«é “ç€ã—ãªã„ãªã‚‰ã€`1` ã‚’ 10
å€‹è¶³ã—åˆã‚ã›ã¦ã‚‚ã‚‚ã¡ã‚ã‚“ 10 ãŒä½œã‚Œã‚‹)ã€‚

ã¾ãŸã€`error_reporting` ã«æŒ‡å®šã—ã¦ã„ã‚‹ã®ã¯ `-1` ã§ã‚ã‚‹ã€‚
ã“ã‚Œã¯ã€`!` ã«ã‚ˆã£ã¦æ–‡å­—åˆ—ã‚’ `false` ã«ã—ã€`+` ã«ã‚ˆã£ã¦ `false` ã‚’ `0` ã«ã—ã€ã•ã‚‰ã«ãƒ“ãƒƒãƒˆåè»¢ã—ã¦ `-1` ã«ã—ã¦ã„ã‚‹ã€‚


### `if` æ–‡ãªã—ã§æ¡ä»¶åˆ†å²

ä¸‰é …æ¼”ç®—å­ãªã„ã— `match` å¼ã‚’ä½¿ã†ã“ã¨ã§ã€`if` ã‚’ä¸€åˆ‡æ›¸ã‹ãšã«æ¡ä»¶åˆ†å²ãŒã§ãã‚‹ã€‚
ã¾ãŸã€`&&` / `||` ã‚‚ä½¿ãˆã‚‹ã“ã¨ãŒã‚ã‚‹ã€‚
é…å»¶è©•ä¾¡ãŒä¸è¦ãªã‚±ãƒ¼ã‚¹ã§ã¯ã€`[$t, $f][$cond]` ã®ã‚ˆã†ãªå½¢ã§åˆ†å²ã™ã‚‹ã“ã¨ã‚‚ã§ãã‚‹ã€‚

### `while`ã€`for` æ–‡ãªã—ã§ãƒ«ãƒ¼ãƒ—

ä¸å‹•ç‚¹ã‚³ãƒ³ãƒ“ãƒãƒ¼ã‚¿ã‚’ä½¿ã£ã¦ç„¡åå†å¸°ã™ã‚‹ (è©³ã—ã„èª¬æ˜ã¯çœç•¥ã™ã‚‹ã€‚ã“ã‚Œã‚‰ã®å˜èªã§æ¤œç´¢ã—ã¦ã»ã—ã„)ã€‚
ã“ã“ã§ã¯ã€ä¸€èˆ¬ã« Z ã‚³ãƒ³ãƒ“ãƒãƒ¼ã‚¿ã¨ã—ã¦çŸ¥ã‚‰ã‚Œã‚‹ã‚‚ã®ã‚’ä½¿ã£ãŸ (`$z`)ã€‚

å®Ÿéš›ã®ã¨ã“ã‚ã€`$ğŸ¤¡` ã‚„ `$ğŸª`ã€`$ğŸ˜` ã¯ã€ä¸€åº¦ Scheme (Lisp ã®ä¸€ç¨®) ã§æ›¸ã„ã¦ã‹ã‚‰ PHP ã«ç¿»è¨³ã™ã‚‹å½¢ã§è¨˜è¿°ã—ãŸã€‚

ãªãŠã€PHP ã¯æœ«å°¾å†å¸°ã®æœ€é©åŒ–ã‚’ãŠã“ãªã‚ãªã„ (å°‘ãªãã¨ã‚‚ä»Šã®ã¨ã“ã‚ã¯) ã®ã§ã€
ã‚ã¾ã‚Šã«é•·ã„ brainf\*ck ãƒ—ãƒ­ã‚°ãƒ©ãƒ ã‚’æ›¸ãã¨ã‚¹ã‚¿ãƒƒã‚¯ã‚ªãƒ¼ãƒãƒ¼ãƒ•ãƒ­ãƒ¼ã™ã‚‹ã€‚


# ç¬¬2å• riddle.php

ã‚½ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ‰ã¯ã“ã¡ã‚‰ã€‚å®Ÿè¡Œã«ã¯ PHP 8.0 ä»¥ä¸ŠãŒå¿…è¦ãªã®ã§æ³¨æ„ã€‚

```php
<?php

/*********************************************************
 * This program displays a PHPer token.                  *
 * Guess 'N'.                                            *
 *                                                       *
 * Hints:                                                *
 * - N itself has no special meaning, e.g., 42, 8128,    *
 *   it is selected at random.                           *
 * - Each element of $token represents a single letter.  *
 * - One letter consists of 5x5 cells.                   *
 * - Remember, the output is a complete PHPer token.     *
 *                                                       *
 * License:                                              *
 *   https://creativecommons.org/publicdomain/zero/1.0/  *
 *********************************************************/
const N = 0 /* Change it to your answer. */;
assert(0 <= N && N <= 0b11111_11111_11111_11111_11111);

$token = [
  0x14B499C,
  0x0BE34CC, 0x01C9C69,
  0x0ECA069, 0x01C2449, 0x0FDB166, 0x01C9C69,
  0x01C1C66, 0x0FC1C47, 0x01C1C66,
  0x10C5858, 0x1E4E3B8, 0x1A2F2F8,
];
foreach ($token as $x) {
  $x = $x ^ N;

  $x = sprintf('%025b', $x);
  $x = str_replace(search: ['0', '1'], replace: [' ', '#'], subject: $x);
  $x = implode("\n", str_split($x, length: 5));
  echo "{$x}\n\n";
}
```

ã•ã¦ã€ã“ã®å•é¡Œã¯ã•ãã»ã©ã®ã‚ˆã†ã«å˜ç´”ã«å®Ÿè¡Œã—ãŸã ã‘ã§ã¯ã€è¬ã®ãƒ–ãƒ­ãƒƒã‚¯ãŒè¡¨ç¤ºã•ã‚Œã‚‹ã ã‘ã§ãƒˆãƒ¼ã‚¯ãƒ³ã¯å¾—ã‚‰ã‚Œãªã„ã€‚
ãƒˆãƒ¼ã‚¯ãƒ³ã‚’å¾—ã‚‹ãŸã‚ã«ã¯ã€ã‚½ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ‰ã‚’èª­ã¿ã€å®šæ•° `N` ã‚’ç‰¹å®šã™ã‚‹å¿…è¦ãŒã‚ã‚‹ã€‚

ã“ã“ã§ã¯ã€ç§ã®æƒ³å®šè§£ã‚’è§£èª¬ã™ã‚‹ã€‚


## èª­è§£

ã¾ãšã¯ã‚½ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ‰ã‚’èª­ã‚“ã§ã„ãã€‚

```php
$token = [
  // ç•¥
];
```

æ•°å€¤ã‹ã‚‰ãªã‚‹ `$token` ãŒã‚ã‚Šã€å„è¦ç´ ã‚’ãƒ«ãƒ¼ãƒ—ã—ã¦ã„ã‚‹ã€‚

```php
  $x = $x ^ N;
```

ã¾ãšã¯æ’ä»–çš„è«–ç†å’Œ (xor) ã‚’å–ã‚Šã€

```php
  $x = sprintf('%025b', $x);
```

äºŒé€²æ•°ã«å¤‰æ›ã—ã¦ã€

```php
  $x = str_replace(search: ['0', '1'], replace: [' ', '#'], subject: $x);
```

0 ã‚’ç©ºç™½ã«ã€1 ã‚’ `#` ã«ã—ã€

```php
  $x = implode("\n", str_split($x, length: 5));
```

5æ–‡å­—ã”ã¨ã«åŒºåˆ‡ã£ãŸã‚ã¨ã€æ”¹è¡Œã§çµåˆã—ã¦ã„ã‚‹ã€‚


## ãƒ’ãƒ³ãƒˆ

æ¬¡ã«ã€ã‚½ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ‰ã«æ›¸ã„ã¦ã‚ã‚‹ãƒ’ãƒ³ãƒˆã‚’èª­ã‚“ã§ã„ãã€‚

* `N` ãã‚Œè‡ªä½“ã¯ã€42 ã‚„ 8128 ã¨ã„ã£ãŸã‚ˆã†ãªç‰¹åˆ¥ãªæ„å‘³ã‚’æŒãŸãšã€ãƒ©ãƒ³ãƒ€ãƒ ã«æ±ºã‚ã‚‰ã‚Œã¦ã„ã‚‹
* `$token` ã®å„è¦ç´ ã¯ã€1æ–‡å­—ã‚’è¡¨ã™
* 1æ–‡å­—ã¯ 5x5 ã®ã‚»ãƒ«ã‹ã‚‰ãªã‚‹
* å‡ºåŠ›ã•ã‚Œã‚‹ã®ã¯ã€å®Œå…¨ãª PHPer ãƒˆãƒ¼ã‚¯ãƒ³ã§ã‚ã‚‹

ã“ã“ã§ã€PHPer ãƒˆãƒ¼ã‚¯ãƒ³ã¯å¿…ãš `#` è¨˜å·ã‹ã‚‰å§‹ã¾ã‚‹ã“ã¨ã‚’æ€ã„ã ã™ã¨ã€
`$token` ã®æœ€åˆã®æ•°å­— `0x14B499C` ã¯ã€å¤‰æ›ã®çµæœ `#` ã«ãªã‚‹ã®ã§ã¯ãªã„ã‹ã¨äºˆæƒ³ã•ã‚Œã‚‹ (ãªãŠã€ã“ã®ã“ã¨ã¯ã€ãƒªãƒã‚¸ãƒˆãƒªã® README ãƒ•ã‚¡ã‚¤ãƒ«ã«è¿½åŠ ãƒ’ãƒ³ãƒˆã¨ã—ã¦æ›¸ã‹ã‚Œã¦ã„ã‚‹)ã€‚


## è§£ã

ã“ã“ã¾ã§ã‚ã‹ã‚Œã°ã€ã‚ã¨ä¸€æ­©ã§è§£ã‘ã‚‹ã€‚ã™ãªã‚ã¡ã€`0x14B499C` ãŒ `#` ã«å¤‰æ›ã•ã‚Œã‚‹ã‚ˆã†ãª `N` ã‚’è¦‹ã¤ã‘ã‚Œã°ã‚ˆã„ã€‚

`N` ã¯é«˜ã€…

```php
assert(0 <= N && N <= 0b11111_11111_11111_11111_11111);
```

ãªã®ã§ãƒ–ãƒ«ãƒ¼ãƒˆãƒ•ã‚©ãƒ¼ã‚¹ã—ã¦ã‚‚ã‚ˆã„ãŒã€ã“ã“ã§ã¯ãƒ–ãƒ«ãƒ¼ãƒˆãƒ•ã‚©ãƒ¼ã‚¹ã—ãªã„æ–¹æ³•ã‚’ç´¹ä»‹ã™ã‚‹ã€‚

```php
<?php

$x = 0x14B499C;

$x = $x ^ N;

$x = sprintf('%025b', $x);
$x = str_replace(search: ['0', '1'], replace: [' ', '#'], subject: $x);
$x = implode("\n", str_split($x, length: 5));

assert($x ===
  " # # \n" .
  "#####\n" .
  " # # \n" .
  "#####\n" .
  " # # ");
```

ã“ã®ä¸€é€£ã®å¤‰æ›ã«å¯¾ã™ã‚‹é€†å¤‰æ›ã‚’è€ƒãˆã‚‹ã¨ã€æ¬¡ã®ã‚ˆã†ã«ãªã‚‹ã€‚

```php
<?php

$x =
  " # # \n" .
  "#####\n" .
  " # # \n" .
  "#####\n" .
  " # # ";

$x = implode('', explode("\n", $x));
$x = str_replace(search: [' ', '#'], replace: ['0', '1'], subject: $x);
$x = bindec($x);

$n = $x ^ 0x14B499C;

echo "N = $n\n";
```

ã“ã‚Œã‚’å®Ÿè¡Œã™ã‚‹ã¨ã€`N` ãŒå¾—ã‚‰ã‚Œã‚‹ã€‚



# ç¬¬3å• toquine.php

ã‚½ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ‰ã¯ã“ã¡ã‚‰ã€‚

```php
<?php

// License: https://creativecommons.org/publicdomain/zero/1.0/
// This is a quine-like program to generate a PHPer token.
// Execute it like this: php toquine.php | php | php | php | ...

$s = <<<'Q'
<?cuc
// Yvprafr: uggcf://perngvirpbzzbaf.bet/choyvpqbznva/mreb/1.0/
// Guvf vf n dhvar-yvxr cebtenz gb trarengr n CUCre gbxra.
// Rkrphgr vg yvxr guvf: cuc gbdhvar.cuc | cuc | cuc | cuc | ...
%f$f = %f;
$f = fge_ebg13($f); $kf = [
%f,
];
$g = ahyy.snyfr; sbe ($v = 0; $v <= vagqvi(__YVAR__-035,6); ++$v) vs (!vffrg($kf[$v])) oernx; ryfr
$g .= vzcybqr("\a", fge_fcyvg(fge_ercynpr(['0','1'], ['  ','##'], fcevags(pue(37) . '025o', $kf[$v])), 012)) . "\a\a";
$jf = neenl_znc(sa($j) => vzcybqr(', ', $j), neenl_puhax(neenl_znc(sa($k) => fcevags('0k' . pue(37) . '07K', $k), $kf), 10));
cevags($f, $g, fge_ebg13("<<<'Q'\a{$f}\aQ"), vzcybqr(",\a", $jf));
Q;
$s = str_rot13($s); $xs = [
0x0AFABEA, 0x1F294A7, 0x1F2109F, 0x1F294A7, 0x0002800, 0x1F2109F, 0x0117041, 0x1F294A7, 0x1FAD6B5, 0x1F295B7,
0x010FC21, 0x1FAD6B5, 0x1151151, 0x010FC21, 0x1F294A7, 0x1F295B7, 0x1FAD6B5, 0x1F294A7, 0x1F295B7, 0x1F8C63F,
0x1F8C631, 0x1FAD6B5, 0x17AD6BD, 0x17AD6BD, 0x1F8C63F, 0x1F295B7,
];
$t = null.false; for ($i = 0; $i <= intdiv(__LINE__-035,6); ++$i) if (!isset($xs[$i])) break; else
$t .= implode("\n", str_split(str_replace(['0','1'], ['  ','##'], sprintf(chr(37) . '025b', $xs[$i])), 012)) . "\n\n";
$ws = array_map(fn($w) => implode(', ', $w), array_chunk(array_map(fn($x) => sprintf('0x' . chr(37) . '07X', $x), $xs), 10));
printf($s, $t, str_rot13("<<<'D'\n{$s}\nD"), implode(",\n", $ws));
```

ã‚³ãƒ¡ãƒ³ãƒˆã«ã‚‚ã‚ã‚‹ã¨ãŠã‚Šã€æ¬¡ã®ã‚ˆã†ã«ã—ã¦å®Ÿè¡Œã™ã‚Œã°ç­”ãˆãŒã§ã¦ãã‚‹ã€‚

```shell-session
$ php toquine.php | php | php | php | ...
```

å®Ÿéš›ã«ã¯ã‚‚ã†å°‘ã—ãƒ‘ã‚¤ãƒ—ã§ç¹‹ã’ãªã‘ã‚Œã°ãªã‚‰ãªã„ã€‚


## è§£èª¬

### ãƒ—ãƒ­ã‚°ãƒ©ãƒ å…¨ä½“

ã‚³ãƒ¡ãƒ³ãƒˆã«ã‚‚ã‚ã‚‹ã¨ãŠã‚Šã€ã“ã‚Œã¯ quine (é¢¨) ã®ãƒ—ãƒ­ã‚°ãƒ©ãƒ ã«ãªã£ã¦ã„ã‚‹ã€‚
Quine ã¨ã¯ã€è‡ªåˆ†ã®ã‚½ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ‰ã‚’ãã£ãã‚Šãã®ã¾ã¾å‡ºåŠ›ã™ã‚‹ã‚ˆã†ãªãƒ—ãƒ­ã‚°ãƒ©ãƒ ã®ã“ã¨ã§ã‚ã‚‹ã€‚

ã“ã®ãƒ—ãƒ­ã‚°ãƒ©ãƒ ã¯ã€å®Ÿè¡Œã™ã‚‹ã¨è‡ªèº«ã¨ã»ã¨ã‚“ã©åŒã˜ãƒ—ãƒ­ã‚°ãƒ©ãƒ ã‚’å‡ºåŠ›ã™ã‚‹ã€‚
ç•°ãªã‚‹ã®ã¯ãƒˆãƒ¼ã‚¯ãƒ³ã«ãªã£ã¦ã„ã‚‹éƒ¨åˆ†ã®ã¿ã§ã‚ã‚‹ã€‚


### ãƒˆãƒ¼ã‚¯ãƒ³

`$xs` ãŒãƒˆãƒ¼ã‚¯ãƒ³ã«å¯¾å¿œã—ã¦ã„ã‚‹ã€‚å¤‰æ›ã®ãƒ­ã‚¸ãƒƒã‚¯ã¯ `riddle.php` ã¨ã»ã¼åŒã˜ãªã®ã§çœç•¥ã™ã‚‹ã€‚


### çŠ¶æ…‹ä¿æŒ

ãƒˆãƒ¼ã‚¯ãƒ³ã®ä½•æ–‡å­—ç›®ã¾ã§å‡ºåŠ›ã—ãŸã‹ã‚’ã€ã‚½ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ‰ã‚’å¤‰ãˆãšã« (quine ãªã®ã§) è¦šãˆã¦ãŠãå¿…è¦ãŒã‚ã‚‹ã€‚
ã“ã®ãƒ—ãƒ­ã‚°ãƒ©ãƒ ã§ã¯ã€ãƒˆãƒ¼ã‚¯ãƒ³ãŒå‡ºåŠ›ã•ã‚Œã‚‹ã¨ã‚½ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ‰ãŒã ã‚“ã ã‚“ã¨é•·ããªã£ã¦ã„ãã®ã‚’åˆ©ç”¨ã—ã¦ã€`__LINE__` ã‹ã‚‰æƒ…å ±ã‚’å–å¾—ã—ã¦ã„ã‚‹ã€‚


### ROT 13

Quine ã¯ã€ç´ æœ´ã«æ›¸ãã¨ãƒ—ãƒ­ã‚°ãƒ©ãƒ ã®ä¸€éƒ¨ãŒ 2å›è¨˜è¿°ã•ã‚Œã¦ã—ã¾ã†ã€‚
ã“ã‚ŒãŒã‚ã¾ã‚Šç¾ã—ããªã„ã®ã§ã€`toquine.php` ã§ã¯ã€ROT 13 å¤‰æ›ã‚’ä½¿ã£ã¦é›£èª­åŒ–ã—ãŸã€‚

ãã‚Œã«ã—ã¦ã‚‚ãªãœã“ã‚“ãªã‚‚ã®ãŒæ¨™æº–ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã«â€¦â€¦ã€‚



# ãŠã‚ã‚Šã«

è§£ã„ã¦ã„ãŸã ã„ãŸã¿ãªã•ã‚“ã€ã¾ãŸã€é›£æ˜“åº¦èª¿æ•´ã«ã¤ãã‚ã£ã¦ã„ãŸã ã„ãŸç¤¾å†…ã®ã¿ãªã•ã‚“ã€ã‚ã‚ŠãŒã¨ã†ã”ã–ã„ã¾ã—ãŸã€‚

ä»Šå›ã¯ç›´å‰ã«ä½œã‚Šã¯ã˜ã‚ãŸã®ã‚‚ã‚ã‚Šã€3å•ã ã‘ã‹ã¤ä½¿ã„å¤ã•ã‚ŒãŸãƒã‚¿ã°ã‹ã‚Šã«ãªã£ã¦ã—ã¾ã„ã¾ã—ãŸãŒã€
æ¥å¹´ã¯ 5å•ã€ã‚ˆã‚Šé¢ç™½ã„å•é¡Œã‚’æŒã£ã¦ã„ãã¾ã™ã€‚

å®Ÿã¯ã‚‚ã†ä½œã‚Šã¯ã˜ã‚ã¦ã„ã‚‹ã®ã§ã€ã©ã†ã‹æ¥å¹´ã‚‚ã‚ã‚Šã¾ã™ã‚ˆã†ã«â€¦â€¦ã€‚
